---
title: "시스템프로그래밍"
date: 2020-12-27 12:07:28 -0400
marp: true
categories: systemprogramming system 시스템프로그래밍
---

# 2. 시스템프로그래밍

## 2.3 리눅스 파일 시스템과 관련 쉘 명령어

### 2.3.1  가상 파일 시스템 인터페이스

- VFS 인터페이스 아래 디바이스는 주로 읽기 쓰기로 다뤄진다
- /dev 내 무수한 장치들과 tty (터미널)이 있음
  - tty 파일은 가상 파일 시스템 인터페이스를 통해 가상 터미널 환경이라 하는 가상디바이스에 연결되어있음
  - 즉 키보드 인풋을 주면  터미널 통해 가상파일시스템인터페이스 통해 tty 파일에 저장되는 것임
  - 이 같은 원리로 디바이스와 운영체제는 통신함
  - OS <----> VFS interface <----> tty <----> device 

### 2.3.2 파일 시스템 탐색

- 리눅스 파일 탐색: 예 - /home/ubuntu/link.txt
- 각 디렉토리 엔트리(dentry)를 탐색
  - 각 엔트리는 해당 디렉토리 파일, 디렉토리 정보를 가짐
- /home/ubuntu/link.txt 탐색 예시
  - / dentry 에서 home의 디렉토리 inode를 찾고 home inode의 덴트리에서 ubuntu 찾고, ubuntu inode의 덴트리에서 link.txt 파일 이름과 inode를 얻음
  - ![image-20201227013026509](../images/image-20201227013026509.png)

### 2.3.2 하드링크와 소프트(심볼릭)링크

- 파일복사 `cp`
  - cp A B --> A와 B 물리적으로 크기 복사
- 하드링크 `ln`
  - ln A B --> A와 B는 동일한 크기 파일을 가리킴
  - 동일한 파일을 가진 이름 하나 더 추가하므로 inode는 동일하면서, 전체 파일 용량은 달라지지 않음
  - ![image-20201227015616056](../images/image-20201227015616056.png)
    - cp의 경우 원본과 파일네임도, 아이노드도 , 저장공간도 다름
    - 원본 파일 삭제해도, 아이노드 구조체(물리공간)는 남아있음. 
      - 하드링크 파일의 내용은 살아있어서 그대로 읽을 수 있음
- 소프트(심볼릭)링크
  - ln -s A B
  - windows 바로가기와 동일
  - 원본과 inode 값이 다르며, 원본파일이 없어지면 값을 읽을 수 없음
  - ls -al 시 맨 앞이 l 로 나옴
  - ![image-20201227024804044](../images/image-20201227024804044.png)
    - Redirected path에 원본파일 아이노드 구조체의 address를 가리키는데 원본파일이 삭제되면 redirection이 안됨
- 특수파일
  - 블록 디바이스
    - 저장매체. 블록 또는 섹터 등 정해진 단위로 데이터 전송. IO 송수신 속도 높음
  - 캐릭터 디바이스
    - 키보드, 마우스 등 byte 단위 데이터 전송, IO 송수신 속도 낮음
- 파일시스템 정리
  - 파일 추상화 인터페이스를 활용 다양한 데이터/디바이스 접근
  - 파일 네임스페이스는 전역 네임스페이스 활용
  - 파일:inode로 매칭. 파일 시스템은 inode 기반 접근
  - 하드링크: 동일 inode 가리키는 파일 이름만 하나 더 만듬
    - inode 구조체에 링크카운트 정보 들어있음. 몇개 파일과 연결되어있는지
  - 소프트 링크: 특정 파일 바로가기 파일 만듬
  - 특수파일: 블록/캐릭터 디바이스

