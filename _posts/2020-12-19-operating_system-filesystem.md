---
title: "파일 시스템"
date: 2020-12-19 02:00:28 -0400
marp: true
categories: OS 운영체제 파일시스템 FileSystem
---

# 1. 운영체제

## 1.6. 파일 시스템

### 1.6.1. 파일 시스템 개념

- 운영체제가 저장매체에 파일을 쓰기 위한 자료구조 또는 알고리즘

- 파일시스템 만들어진 이유

  - 0과 1의 데이터를 어떻게 저장매체에 저장할까?

    - 비트단위로 관리하기엔 오버헤드가 너무 큼 (주소 수 너무 많음)

      - 블록 단위로 관리하기로 함 (4KB -> 주소 수 절약)

      - 블록마다 고유번호를 부여해서 관리
        - 문제: 사용자가 각 블록 고유 번호 관리하기 어려움
          - 사용자가 이해하기 쉬운 추상적(논리적) 객체 필요 -> 파일
        - 사용자는 파일 단위로 관리
          - 각 파일은 블록 단위로 관리

  - 저장 매체에 효율적으로 파일을 저장하는 방법은 무엇일까?

    - 가능한 연속적인 공간에 파일 저장하는 것이 좋음
    - 그러나 외부 단편화의 문제 팔생하여 불연속 공간에 파일 저장 기능 지원 필요
      - 블록체인: 블록을 Linked List로 연결
        - 끝에 있는 블록을 찾으려면 맨 처음 블록부터 주소를 따라가야함
      - 인덱스 블록 기법: 각 블록에 대한 위치 정보를 기록해서, 한번에 끝 블록을 찾아갈 수 있도록 함

- 다양한 파일 시스템

  - Windows: FAT, FAT32, NTFS
    - 블록 위치를 FAT이라는 자료 구조에 기록
  - Linux: ext2, ext3, ext4
    - 일종의 인덱스 블록 기법인 inode 방식 사용

- 운영체제에서 이미 파일시스템에 맞게 내부적으로 시스템콜을 제공하기 때문에 유저 입장에서는 파일시스템을 고려하지 않음



### 1.6.2 inode 방식 파일 시스템

- 파일 시스템 기본 구조 3가지
  - 수퍼 블록: 파일 시스템 정보를 가지고 있는 것 (시스템 정보, 파티션 정보 등) `$ df`
  - 아이노드 블록: 파일 상세 정보 (마치 프로세스에서 PCB 같은 역할)
  - 데이터 블록: 실제 데이터 
- 수퍼 블록
  - `$ df`

- 아이노드 블록
  - 아이노드와 파일간의 관계
    - 파일: inode 고유값과 자료구조에 의해 주요 정보 관리
      - 파일이름: inode 로 파일 이름은 inode 번호와 매칭
      - 파일시스템에서는 inode를 기반으로 파일 엑세스
      - inode 블록에는 파일에 대한 상세정보가 들어감 (메타데이터 저장)
      - ![image-20201219014045056](../images/image-20201219014045056.png)
- inode 구조와 파일 데이터 
  - ![image-20201219014642812](../images/image-20201219014642812.png)
- 디렉토리 엔트리 구조
  - 리눅스 파일 탐색하는 방법.
  - `/home/ubuntu/link.txt` 라면 / -> home -> ubuntu -> link.txt 의 inode 획득

- 가상 파일 시스템 (VFS, Virtual File System)
  - 네트워크 등 다양한 기기도 동일한 파일 시스템 인터페이스로 관리 가능 (VFS interface)
  - 로컬 디스크가 아닌 원격지 디스크의 파일을 읽고 쓸 수 있음
    - read/write 시스템 콜을 사용해서 가능함.
    - 각 기기별 read_spec/write_spec 코드가 운영체제 내부에서 구현되어있기 때문
  - 모든 자원에 대한 **추상화 인터페이스**로 파일 인터페이스를 활용 가능함
  - 디스크 이외에도 다른 모든 디바이스(마우스, 키보드 등) 관련 기술은 파일과 같이 다루어짐
  - (참고)디바이스 종류
    - 블록 디바이스
      - HDD, CD/DVD 등 블록 또는 섹터 등 정해진 단위로 데이터 전송. IO 송수신 속도가 높음
    - 캐릭터 디바이스
      - 키보드, 마우스 등 byte 단위 데이터 전송, IO 송수신 속도 낮음



